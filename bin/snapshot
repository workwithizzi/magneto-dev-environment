#!/bin/bash
# Creates backup of mysql db and src directory
source bin/utils

TIME="$(date +'%y%m%d_%H%M%S')"

if [ -z "$1" ]; then
	TITLE="$TIME"
else
	TITLE="${TIME}-$1"
fi

SNAPSHOT_DIR="_ref/snapshots/$TITLE"

# Get backup of db
bin/mysqlexport "$TITLE"


mkdir -p "$SNAPSHOT_DIR"

mv "db/$TITLE.sql" "$SNAPSHOT_DIR/$TITLE.sql"

print_doing "Moving db backup and a copy of the src directory to:"
echo "   _ref/snapshots/$TITLE"

cp -r "src" "$SNAPSHOT_DIR/src"